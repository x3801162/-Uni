{"version":3,"file":"index-doctor.js","sources":["components/index-doctor.vue","../../../../HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RTovY29kZS91bmkv5rWO5Y2XVW5pL-a1juWNl1VuaS9jb21wb25lbnRzL2luZGV4LWRvY3Rvci52dWU"],"sourcesContent":["<template>\r\n    <div class=\"recommend-doctors\" v-if=\"formattedDoctorList.length > 0\">\r\n        <!-- 替换微信小程序语法为Vue语法，保留核心渲染逻辑 -->\r\n        <div class=\"doctorcard\" v-for=\"(doctor, index) in formattedDoctorList\" :key=\"doctor.id\">\r\n            <div class=\"doctor\" @click=\"bookAppointment(doctor)\">\r\n                <img class=\"doctor-img\" style=\"object-fit: cover\" mode=\"aspectFill\" :src=\"doctor.avatar\" alt=\"医生头像\">\r\n                <div class=\"doctor-info\">\r\n                    <div class=\"doctorveiw\">\r\n                        <span class=\"name\">{{ doctor.name }}</span>\r\n                        <span class=\"subtitle\">{{ doctor.professional }}</span>\r\n                    </div>\r\n                    <span class=\"doctor-title\">{{ doctor.positions }}</span>\r\n                </div>\r\n                <div class=\"doctor-button\" :style=\"{ border: `1px solid ${color}`, color: color }\">\r\n                    预约挂号\r\n                </div>\r\n            </div>\r\n            <div class=\"doctor-desc\" @click=\"bookAppointment(doctor)\">\r\n                {{ '擅长：' + doctor.proficient_in }}\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, onMounted, computed } from 'vue'\r\nimport { VUE_APP_STATIC_URL } from '../config/api'\r\n\r\n// 关键修改1：拆解冗余的MenuItem结构，直接定义核心的Doctor接口\r\n// 贴合后端真实返回类型，区分必选/可选字段\r\ninterface Doctor {\r\n    // 模板必用字段（必选）\r\n    id: number; // 后端返回number，修正你之前的string错误\r\n    name: string;\r\n    avatar: string;\r\n    professional: string;\r\n    positions: string; // 后端返回字符串，不是数组\r\n    proficient_in: string;\r\n    is_active: boolean;\r\n\r\n    // 后端返回但模板未用的字段（可选，留扩展）\r\n    hospital_name?: string;\r\n    doctor_category?: number;\r\n    disease_types?: number;\r\n    con_room?: string | null; // 后端可能返回null，标记可空\r\n    original_price?: number;\r\n    price?: number;\r\n    follow_up_price?: number;\r\n    re_count?: number;\r\n    order?: number;\r\n    intro?: string;\r\n    image_url?: string;\r\n    patients_amount?: number;\r\n    positive_review?: number;\r\n    connected_calls?: number;\r\n    share_img?: string;\r\n    is_rest?: boolean;\r\n    am?: string | null;\r\n    pm?: string | null;\r\n    depts_id?: number;\r\n    create_user_id?: number;\r\n}\r\n\r\n// 关键修改2：修正props类型，直接约束为Doctor数组（去掉MenuItem外层）\r\nconst props = defineProps({\r\n    doctorList: {\r\n        type: Array as () => Doctor[],\r\n        default: () => []\r\n    },\r\n    // 补充color属性（模板中用到了color变量）\r\n    color: {\r\n        type: String,\r\n        default: '#1677ff' // 默认蓝色，可由父组件传入\r\n    }\r\n})\r\n\r\n// 关键修改3：修正formatDoctor的返回类型，实现数据筛选+兜底\r\nconst formatDoctor = (rawDoctor: any): Doctor => {\r\n    return {\r\n        // 必选字段：兜底+类型修正\r\n        id: rawDoctor.id || 0, // 确保是number类型\r\n        name: rawDoctor.name || '未知医生',\r\n        // 拼接完整头像地址，处理空值\r\n        avatar: rawDoctor.avatar\r\n            ? `${VUE_APP_STATIC_URL}${rawDoctor.avatar}`\r\n            : '/default-avatar.png',\r\n        professional: rawDoctor.professional || '未知职称',\r\n        positions: rawDoctor.positions.split('<br/>')[0] || '未知职位',\r\n        proficient_in: rawDoctor.proficient_in || '暂无擅长领域',\r\n        is_active: rawDoctor.is_active ?? false, // 空值合并，确保布尔值\r\n    }\r\n}\r\n\r\n// 关键修改4：计算属性 - 格式化+过滤激活的医生列表\r\nconst formattedDoctorList = computed(() => {\r\n    return props.doctorList\r\n        .map(rawDoctor => formatDoctor(rawDoctor)) // 格式化每条数据\r\n        .filter(doctor => doctor.is_active) // 只保留激活的医生\r\n})\r\n\r\n// 关键修改5：定义预约挂号方法（模板中绑定了点击事件）\r\nconst bookAppointment = (doctor: Doctor) => {\r\n    // 这里写预约挂号的逻辑，比如跳转页面、传参等\r\n    uni.__f__('log','at components/index-doctor.vue:104','预约挂号：', doctor)\r\n    // 示例：可抛出事件给父组件\r\n    // emit('book', doctor)\r\n}\r\n\r\n// 如需对外暴露方法，可添加emit（可选）\r\n// const emit = defineEmits<{\r\n//   (e: 'book', doctor: Doctor): void\r\n// }>()\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n    \r\n  .recommend-doctors {\r\n    background: #fff;\r\n    border-radius: 20rpx;\r\n    padding-bottom: 20rpx;\r\n    width: 700rpx;\r\n    margin: auto;\r\n  }\r\n  \r\n  .recommend-more {\r\n    -webkit-box-pack: justify;\r\n    -webkit-box-align: end;\r\n    align-items: flex-end;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    padding: 20rpx;\r\n  }\r\n  \r\n  .recommend-more .title {\r\n    color: #000;\r\n    font-size: 36rpx;\r\n    font-weight: 700;\r\n  }\r\n  \r\n  .recommend-more .more {\r\n    color: #666;\r\n    font-size: 24rpx;\r\n  }\r\n  \r\n  .doctor {\r\n    -webkit-box-pack: justify;\r\n    -webkit-box-align: center;\r\n    align-items: center;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    padding: 24rpx;\r\n  }\r\n  \r\n  .doctor-img {\r\n    border-radius: 50%;\r\n    height: 105rpx;\r\n    margin-right: 16rpx;\r\n    width: 105rpx;\r\n  }\r\n  \r\n  .doctor-title {\r\n    color: #000;\r\n    font-size: 24rpx;\r\n    line-height: 50rpx;\r\n  }\r\n  \r\n  .doctor-info {\r\n    -webkit-box-flex: 1;\r\n    -webkit-box-orient: vertical;\r\n    -webkit-box-direction: normal;\r\n    -webkit-box-pack: justify;\r\n    display: flex;\r\n    flex: 1;\r\n    flex-direction: column;\r\n    justify-content: space-between;\r\n    margin-left: 20rpx;\r\n  }\r\n  \r\n  .doctor-info .name {\r\n    color: #000;\r\n    font-size: 32rpx;\r\n    font-weight: 700;\r\n    line-height: 45rpx;\r\n  \r\n  \r\n  }\r\n  \r\n  .doctors-no {\r\n    min-width: 100rpx;\r\n    min-height: 30rpx;\r\n    background-color: #F8F8F8;\r\n  }\r\n  \r\n  \r\n  \r\n  .doctor-info .subtitle {\r\n    background: #f4e9d7;\r\n    border-radius: 8rpx;\r\n    color: #a27f5a;\r\n    font-size: 24rpx;\r\n    height: 40rpx;\r\n    margin-left: 15rpx;\r\n    padding: 5rpx 10rpx;\r\n    min-width: 100rpx;\r\n    min-height: 30rpx;\r\n  }\r\n  \r\n  .doctor-desc {\r\n    background: #f5f8f7;\r\n    margin: auto;\r\n    overflow: hidden;\r\n    padding: 5rpx;\r\n    padding-top: 15rpx;\r\n    padding-left: 15rpx;\r\n    padding-right: 15rpx;\r\n    display: -webkit-box;\r\n    -webkit-box-orient: vertical;\r\n    -webkit-line-clamp: 2;\r\n    /* 限制文本为两行 */\r\n    overflow: hidden;\r\n    /* height: 85rpx; */\r\n    width: 650rpx;\r\n  }\r\n  \r\n  .doctor-button {\r\n    border: 1px solid #C8A063;\r\n    border-radius: 8px;\r\n    border-radius: 8rpx;\r\n    color: #C8A063;\r\n    font-size: 24rpx;\r\n    height: 53rpx;\r\n    line-height: 50rpx;\r\n    text-align: center;\r\n    width: 150rpx;\r\n  }\r\n  \r\n  .doctorcard {\r\n    margin-bottom: 40rpx;\r\n  }\r\n  \r\n  .doctorremind {\r\n    height: 40rpx;\r\n    overflow: hidden;\r\n    width: 550rpx;\r\n  }\r\n  \r\n  .doctorremind .item {\r\n    width: 100%;\r\n  }\r\n</style>","import Component from 'E:/code/uni/济南Uni/济南Uni/components/index-doctor.vue'\nwx.createComponent(Component)"],"names":["VUE_APP_STATIC_URL","computed","uni"],"mappings":";;;;;;;;;;;;;;;;;;AAgEA,UAAM,QAAQ;AAaR,UAAA,eAAe,CAAC,cAA2B;AACtC,aAAA;AAAA;AAAA,QAEH,IAAI,UAAU,MAAM;AAAA;AAAA,QACpB,MAAM,UAAU,QAAQ;AAAA;AAAA,QAExB,QAAQ,UAAU,SACZ,GAAGA,WAAkB,kBAAA,GAAG,UAAU,MAAM,KACxC;AAAA,QACN,cAAc,UAAU,gBAAgB;AAAA,QACxC,WAAW,UAAU,UAAU,MAAM,OAAO,EAAE,CAAC,KAAK;AAAA,QACpD,eAAe,UAAU,iBAAiB;AAAA,QAC1C,WAAW,UAAU,aAAa;AAAA;AAAA,MAAA;AAAA,IACtC;AAIE,UAAA,sBAAsBC,cAAAA,SAAS,MAAM;AAChC,aAAA,MAAM,WACR,IAAI,CAAa,cAAA,aAAa,SAAS,CAAC,EACxC,OAAO,CAAU,WAAA,OAAO,SAAS;AAAA,IAAA,CACzC;AAGK,UAAA,kBAAkB,CAAC,WAAmB;AAExCC,oBAAA,MAAI,MAAM,OAAM,sCAAqC,SAAS,MAAM;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;ACtGxE,GAAG,gBAAgB,SAAS;"}