{"version":3,"file":"cascade.mjs","sources":["../../src/picker/cascade.vue","../../src/picker/cascade.vue?vue&type=template&id=dfef1a7e&lang.js"],"sourcesContent":["<template>\n  <picker\n    v-bind=\"pickerProps\"\n    :columns=\"(selected) => generateCascadePickerColumns(selected, columns, finalDepth, finalSubOptionsRecord)\"\n  />\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, ref } from 'vue';\nimport { get as lodashGet } from 'lodash-es';\nimport config from '../config';\nimport { KeysType } from '../common';\nimport PickerProps from './props';\nimport { PickerColumn, PickerValue } from './type';\nimport Picker from './picker';\n\nconst { prefix } = config;\nconst name = `${prefix}-cascade`;\nexport default defineComponent({\n  name,\n  components: { Picker },\n  props: PickerProps,\n  setup(props: any, context) {\n    const pickerProps = computed(() => ({ ...props }));\n    const keys = computed((): KeysType => props.keys);\n    const finalDepth = ref(1);\n    const finalSubOptionsRecord = ref({});\n    const generateCascadePickerColumns = (\n      value: PickerValue[],\n      options: any,\n      depth: number,\n      subOptionsRecord: Record<string, any>,\n    ) => {\n      const columns: PickerColumn[] = [];\n      columns.push(\n        options.map((option: any) => ({\n          label: option.label,\n          value: option.value,\n        })),\n      );\n      for (let i = 0; i < depth - 1; i++) {\n        const x = value[i];\n        const subOptions = subOptionsRecord[x];\n        if (!subOptions) {\n          columns.push([]);\n        } else {\n          columns.push(\n            subOptions.map((option: any) => ({\n              label: option.label,\n              value: option.value,\n            })),\n          );\n        }\n      }\n      return columns;\n    };\n    const initDepthAndRecord = (options: any) => {\n      let depth = 1;\n      const subOptionsRecord: Record<string, any[]> = {};\n      function traverse(option: any, currentDepth: number) {\n        if (!option.children) {\n          return;\n        }\n        subOptionsRecord[lodashGet(option, keys.value?.value ?? 'value')] = option.children;\n        const nextDepth = currentDepth + 1;\n        if (nextDepth > depth) {\n          depth = nextDepth;\n        }\n        option.children.forEach((option: any) => {\n          traverse(option, nextDepth);\n        });\n      }\n      options.forEach((option: any) => {\n        traverse(option, 1);\n      });\n      finalDepth.value = depth;\n      finalSubOptionsRecord.value = subOptionsRecord;\n    };\n    initDepthAndRecord(props.columns);\n\n    return {\n      name,\n      finalDepth,\n      finalSubOptionsRecord,\n      pickerProps,\n      generateCascadePickerColumns,\n    };\n  },\n});\n</script>\n","<template>\n  <picker\n    v-bind=\"pickerProps\"\n    :columns=\"(selected) => generateCascadePickerColumns(selected, columns, finalDepth, finalSubOptionsRecord)\"\n  />\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, ref } from 'vue';\nimport { get as lodashGet } from 'lodash-es';\nimport config from '../config';\nimport { KeysType } from '../common';\nimport PickerProps from './props';\nimport { PickerColumn, PickerValue } from './type';\nimport Picker from './picker';\n\nconst { prefix } = config;\nconst name = `${prefix}-cascade`;\nexport default defineComponent({\n  name,\n  components: { Picker },\n  props: PickerProps,\n  setup(props: any, context) {\n    const pickerProps = computed(() => ({ ...props }));\n    const keys = computed((): KeysType => props.keys);\n    const finalDepth = ref(1);\n    const finalSubOptionsRecord = ref({});\n    const generateCascadePickerColumns = (\n      value: PickerValue[],\n      options: any,\n      depth: number,\n      subOptionsRecord: Record<string, any>,\n    ) => {\n      const columns: PickerColumn[] = [];\n      columns.push(\n        options.map((option: any) => ({\n          label: option.label,\n          value: option.value,\n        })),\n      );\n      for (let i = 0; i < depth - 1; i++) {\n        const x = value[i];\n        const subOptions = subOptionsRecord[x];\n        if (!subOptions) {\n          columns.push([]);\n        } else {\n          columns.push(\n            subOptions.map((option: any) => ({\n              label: option.label,\n              value: option.value,\n            })),\n          );\n        }\n      }\n      return columns;\n    };\n    const initDepthAndRecord = (options: any) => {\n      let depth = 1;\n      const subOptionsRecord: Record<string, any[]> = {};\n      function traverse(option: any, currentDepth: number) {\n        if (!option.children) {\n          return;\n        }\n        subOptionsRecord[lodashGet(option, keys.value?.value ?? 'value')] = option.children;\n        const nextDepth = currentDepth + 1;\n        if (nextDepth > depth) {\n          depth = nextDepth;\n        }\n        option.children.forEach((option: any) => {\n          traverse(option, nextDepth);\n        });\n      }\n      options.forEach((option: any) => {\n        traverse(option, 1);\n      });\n      finalDepth.value = depth;\n      finalSubOptionsRecord.value = subOptionsRecord;\n    };\n    initDepthAndRecord(props.columns);\n\n    return {\n      name,\n      finalDepth,\n      finalSubOptionsRecord,\n      pickerProps,\n      generateCascadePickerColumns,\n    };\n  },\n});\n</script>\n"],"names":["prefix","config","name","defineComponent","components","Picker","props","PickerProps","setup","context","pickerProps","computed","_objectSpread","keys","finalDepth","ref","finalSubOptionsRecord","generateCascadePickerColumns","value","options","depth","subOptionsRecord","columns","push","map","option","label","i","x","subOptions","initDepthAndRecord","traverse","currentDepth","_keys$value$value","_keys$value","children","lodashGet","nextDepth","forEach","_createBlock","_component_picker","_mergeProps","_ctx","selected"],"mappings":"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"}